# üîí –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## ‚úÖ **–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

1. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ —É—Ç–µ—á–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤**: –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –∏–∑ API
2. **–ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: DTO —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: TelegramAuthGuard –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ userId
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ó–∞–ø–∏—Å—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞**: –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ seeds/content.json

## üö® **–¢–µ–∫—É—â–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**

### 1. **IDOR (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è)**
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å —á—É–∂–æ–π `userId` –∏ –ø–æ–ª—É—á–∏—Ç—å —á—É–∂–∏–µ –¥–∞–Ω–Ω—ã–µ
```bash
# –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
GET /content/modules?userId=123456&level=A1
```

**–†–µ—à–µ–Ω–∏–µ:** JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (—Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)

### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting**
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–º–æ–∂–Ω—ã DDoS-–∞—Ç–∞–∫–∏ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è API
**–†–µ—à–µ–Ω–∏–µ:** Nginx rate limiting –∏–ª–∏ Redis-based middleware

### 3. **–°–ª–∞–±–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Telegram –¥–∞–Ω–Ω—ã—Ö**
**–ü—Ä–æ–±–ª–µ–º–∞:** userId –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, –Ω–æ –Ω–µ –Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å
**–†–µ—à–µ–Ω–∏–µ:** –°–≤—è–∑–∞—Ç—å —Å–µ—Å—Å–∏—é —Å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ Telegram-–¥–∞–Ω–Ω—ã–º–∏

## üéØ **–ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):**

### **–≠—Ç–∞–ø 1: JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```typescript
// –ü–æ—Å–ª–µ /auth/verify –≤—ã–¥–∞–≤–∞—Ç—å JWT —Ç–æ–∫–µ–Ω
POST /auth/verify ‚Üí { token: "jwt-token", user: {...} }

// –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω
GET /content/modules
Headers: Authorization: Bearer jwt-token
```

### **–≠—Ç–∞–ø 2: Rate Limiting**
```nginx
# –í nginx.conf
limit_req_zone $binary_remote_addr zone=api:10m rate=30r/m;
location /api/ {
    limit_req zone=api burst=10 nodelay;
}
```

### **–≠—Ç–∞–ø 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
```typescript
// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ß–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å —Ä–∞–∑–Ω—ã–º–∏ userId —Å –æ–¥–Ω–æ–≥–æ IP
- –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –ü–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–±–æ—Ä–∞ userId
```

### **–≠—Ç–∞–ø 4: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è**
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Telegram Mini App
- –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram WebApp –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Pagination –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

## üîß **–ë—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞):**

### 1. –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç IDOR:
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ "—Ä–∞–∑—É–º–Ω–æ—Å—Ç–∏" –∑–∞–ø—Ä–æ—Å–æ–≤
if (requestedUserId !== authenticatedUserId && !isAdmin) {
  // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
  return { error: 'Access denied' };
}
```

### 2. –û–±—Ñ—É—Å–∫–∞—Ü–∏—è userId:
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ userId –≤ URL
const hashedUserId = crypto.createHash('sha256').update(userId + secret).digest('hex').substring(0, 16);
```

### 3. –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã:
```typescript
// –í—ã–¥–∞–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã (1 —á–∞—Å) –ø–æ—Å–ª–µ /auth/verify
const sessionToken = jwt.sign({ userId, exp: Date.now() + 3600000 }, secret);
```

## üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP
- –ß–∞—Å—Ç–æ—Ç–∞ —Å–º–µ–Ω—ã userId –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º
- –ê–Ω–æ–º–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ—Å—Ç—É–ø –∫ —É—Ä–æ–∫–∞–º –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞)

### –ê–ª–µ—Ä—Ç—ã:
- –ë–æ–ª–µ–µ 100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω —Å –æ–¥–Ω–æ–≥–æ IP
- –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º >5 —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–¥–Ω–æ–≥–æ IP
- –ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é:**

**–ë—ã—Å—Ç—Ä–æ (1-2 –¥–Ω—è):**
- –î–æ–±–∞–≤–∏—Ç—å nginx rate limiting
- –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ (1 –Ω–µ–¥–µ–ª—è):**
- –í–Ω–µ–¥—Ä–∏—Ç—å JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- –î–æ–±–∞–≤–∏—Ç—å Redis –¥–ª—è —Å–µ—Å—Å–∏–π

**–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ (1 –º–µ—Å—è—Ü):**
- –ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
